(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["occupy"],{"219e":function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("ActionsTabs"),s("div",{staticClass:"p-4 mt-2 columns"},[e.ownUnits.length>0?s("div",{staticClass:"column b col-6 text-center"},[s("h3",[e._v("Select your army composition")]),s("div",e._l(e.ownUnits,(function(t){return s("div",{key:t.key},[t.amount>0?s("UnitSelect",{key:t.key,attrs:{item:t},on:{click:e.addUnit}}):e._e()],1)})))]):e._e(),e.ownUnits.length>0?s("div",{staticClass:"column b col-6 text-center"},[s("div",[s("div",{staticClass:"mb-2"},[s("h3",{staticClass:"mb-2"},[e._v("Your selected army")]),s("ArmyToSend",{attrs:{units:e.selectedUnits}})],1)]),s("div",{staticClass:"mb-0 form width-full"},[0===e.selectedUnits.length?s("div",[s("p",[e._v("You need to select at least 1 occupation troop.")])]):e._e()]),s("h3",[e._v("Select your target user")]),s("div",[e._v("\n                Territory :\n                "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.territory,expression:"territory"}],staticClass:"input form-control mb-4",attrs:{type:"number",placeholder:"Territory"},domProps:{value:e.territory},on:{input:function(t){t.target.composing||(e.territory=t.target.value)}}})]),s("div",[e._v("\n                Base :\n                "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.base,expression:"base"}],staticClass:"input form-control mb-4",attrs:{type:"number",placeholder:"Base"},domProps:{value:e.base},on:{input:function(t){t.target.composing||(e.base=t.target.value)}}})]),s("div",[e._v("\n                Name :\n                "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],staticClass:"input form-control mb-4",attrs:{placeholder:"Base name"},domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}})]),s("UiButton",{staticClass:"button button-large button-blue mb-4",attrs:{disabled:0===e.selectedUnits.length||!e.territory||e.hasNotEnough||e.isLoading||e.selectedTotal>e.carry},on:{click:e.handleSubmit}},[e.isLoading?s("SmallLoading"):s("span",[e._v("Take base")])],1),e.errorMessage?s("p",{staticClass:"text-red text-left"},[e._v("\n                "+e._s(e.errorMessage)+"\n            ")]):e._e()],1):s("div",[s("p",[e._v("You don't have any unit.")])])])],1)},n=[],a=s("a4bb"),i=s.n(a),o=(s("ac6a"),s("7514"),s("7f7f"),s("c5f6"),s("96cf"),s("3b8d")),u=s("59ad"),c=s.n(u),l=s("cebc"),m=s("e814"),h=s.n(m),d=s("2f62"),b=s("451e"),p=(s("7edb"),{data:function(){return{isLoading:!1,territory:this.$route.query.target||null,base:this.$route.query.base||null,selectedUnits:[],message:null,name:null,username:this.$store.state.auth.username,errorMessage:null}},created:function(){},computed:{user:function(){return this.$store.state.game.user.user},sent_fights:function(){return this.$store.state.game.sent_fights},nickname:function(){return this.$store.state.game.user.user.nickname},ownBase:function(){return this.$store.state.game.mainbase},ownUnits:function(){return this.$store.state.game.user.units.map((function(e){return{key:e.unit,amount:e.amount}}))},hasNotEnough:function(){return h()(this.drugs_amount)>this.user.drugs_balance||h()(this.weapons_amount)>this.user.weapons_balance||h()(this.alcohol_amount)>this.user.alcohols_balance||h()(this.dwd_amount)>this.user.dwd}},methods:Object(l["a"])({},Object(d["b"])(["send","init","get_bases","setBase"]),{resetForm:function(){this.territory=null,this.selectedUnits=[],this.base=null,this.name=null},progressPercent:function(e,t){var s;return e&&t?(this.up=!1,s=c()(100*e/t).toFixed(2),s):(this.up=!1,0)},removeUnits:function(){this.selectedUnits=[]},handleSubmit:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s,r,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this,e.next=3,this.validateForm();case 3:s=e.sent,s?(this.isLoading=!0,this.territory>0&&this.base>0?(r={territory:Number(this.territory),base:Number(this.base),name:this.name,type:"dw-base"},this.send(r).then((function(){t.resetForm(),b["a"].requestAsync("get_bases",n.location).then((function(e){t.init(),t.isLoading=!1})),t.isLoading=!1})).catch((function(e){console.error("Failed to start a fight=",e),n.isLoading=!1}))):(this.isLoading=!1,this.errorMessage="Not enough resources?")):this.isLoading=!1;case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),validateForm:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,s,r,n,a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.errorMessage=null,t=this.base,s=this.territory,r={base:t,territory:s},n=new Date,this.name||(this.errorMessage="Please choose a name for your base"),this.name.length>25&&(this.errorMessage="Please choose a shorter name for your base"),a=new Date(Date.parse(this.$store.state.game.user.user.punished)),a>n&&(this.errorMessage="Hmm Bad talks are not appropriated in DrugWars, try again after ".concat(a.toLocaleString())),this.errorMessage){e.next=23;break}return e.prev=10,e.next=13,b["a"].requestAsync("check_base",r);case 13:return i=e.sent,i&&(this.errorMessage="Base number '".concat(t,"' is already taken")),e.abrupt("return",!this.errorMessage);case 18:return e.prev=18,e.t0=e["catch"](10),this.errorMessage="Base number '".concat(t,"' doesn't exist"),console.error("Base number '".concat(t,"' doesn't exist"),e.t0),e.abrupt("return",!1);case 23:if(!this.errorMessage){e.next=25;break}return e.abrupt("return",!1);case 25:return e.abrupt("return",!this.errorMessage);case 26:case"end":return e.stop()}}),e,this,[[10,18]])})));function t(){return e.apply(this,arguments)}return t}(),addUnit:function(e){var t=h()(e.amount),s={},r=this.ownUnits.find((function(t){return t.key===e.key}));this.selectedUnits.forEach((function(e){s[e.key]=e.amount})),s[e.key]=s[e.key]?t+h()(s[e.key]):t,s[e.key]>r.amount&&(s[e.key]=h()(r.amount)),s[e.key]<0&&(s[e.key]=0),this.selectedUnits=i()(s).map((function(e){return{key:e,amount:s[e]}}))}})}),g=p,f=(s("bcfd"),s("2877")),v=Object(f["a"])(g,r,n,!1,null,"63eb1571",null);t["default"]=v.exports},aab7:function(e,t,s){},bcfd:function(e,t,s){"use strict";var r=s("aab7"),n=s.n(r);n.a}}]);
//# sourceMappingURL=occupy.abe83704.js.map