(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["gang"],{"04ac":function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("GangsTabs"),t("div",{staticClass:"p-4 text-center anim-fade-in"},[e.isInit?t("Loading"):t("div",[t("h1",{staticClass:"mb-4"},[e.gang&&e.gang.image?t("GangImage",{staticClass:"mr-3",attrs:{size:"120",image:e.gang.image}}):e._e(),e.gang&e.gang.name?t("div",[e._v(e._s(e.gang.name||e.gang.gang))]):e._e(),t("span",[e._v("["+e._s(e.gang.ticker)+"]")])],1),e.gang.website?t("p",{staticClass:"mb-2"},[t("a",{attrs:{href:e.gang.website,target:"_blank"}},[e._v(e._s(e._f("parseUrl")(e.gang.website)))])]):e._e(),e.gang.about?t("p",{staticClass:"mb-4"},[e._v(e._s(e.gang.about))]):e._e(),e.isBoss?t("router-link",{staticClass:"button button-blue d-inline-block mb-4",attrs:{to:"/gangs/gang/"+e.gang.gang+"/settings"}},[e._v("Settings")]):e._e(),e.user.gang===e.id&&["boss","capo"].includes(e.user.role)&&e.applies&&e.applies.length>0?t("div",[t("h3",[e._v("Pending approval")]),t("div",{staticClass:"mb-4"},e._l(e.applies,(function(s){return t("div",{key:s.username,staticClass:"py-3 border-bottom text-left"},[t("Avatar",{staticClass:"mr-2",attrs:{username:s.username,size:"40"}}),e._v("\n            "+e._s(s.username)+" soldier\n            "),["boss","capo"].includes(e.user.role)?t("UiButton",{staticClass:"button button-red float-right",attrs:{disabled:e.isLoading},on:{click:function(t){e.handleReject(s.username)}}},[e.isLoading?t("SmallLoading"):t("span",[e._v("Reject")])],1):e._e(),t("UiButton",{staticClass:"button button-green float-right mr-2",attrs:{disabled:e.isLoading},on:{click:function(t){e.handleApprove(s.username)}}},[e.isLoading?t("SmallLoading"):t("span",[e._v("Approve")])],1),t("div",{staticClass:"p-2"},[e._v(e._s(s.message))])],1)})))]):e._e(),t("div",[e.user.gang!==e.id&&1===e.gang.is_stable?t("form",{staticClass:"form text-center",on:{submit:function(s){return s.preventDefault(),e.handleSubmit(s)}}},[t("h3",[e._v("Apply as soldier")]),t("textarea",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],staticClass:"input input-block mb-2",attrs:{type:"text",placeholder:"Message to the boss and capos (optional). They will know your real identity.",maxlength:"280"},domProps:{value:e.message},on:{input:function(s){s.target.composing||(e.message=s.target.value)}}}),t("UiButton",{staticClass:"button button-green btn-block mb-2",attrs:{type:"submit",disabled:e.isLoading}},[e.isLoading?t("SmallLoading"):t("span",[e._v("Apply")])],1)],1):e._e(),t("h3",[e._v("Members")]),e.isBoss||e.isCapo?t("div",[t("strong",[e._v("Active:")]),t("span",[e._v("\n            Today\n            "),t("i",{class:"iconfont icon-check text-green"})]),t("span",[e._v("\n            This month\n            "),t("i",{class:"iconfont icon-check text-orange"})]),t("span",[e._v("\n            Unactive\n            "),t("i",{class:"iconfont icon-check text-red"})])]):e._e(),t("div",{staticClass:"mb-4"},e._l(e.members,(function(s){return t("GangMember",{key:s.nickname,staticClass:"py-3 border-bottom text-left",attrs:{member:s,id:e.id}})})))])],1)],1)],1)},n=[],i=t("cebc"),o=t("768b"),r=(t("ac6a"),t("5df3"),t("6762"),t("2fdb"),t("2f62")),g=t("f684"),l=t.n(g),c=t("451e"),d={data:function(){return{id:this.$route.params.id,isInit:!1,isLoading:!1,gang:null,members:null,message:null,user:this.$store.state.game.user.user,applies:null}},computed:{isBoss:function(){return"boss"===this.user.role&&this.user.gang===this.id},isCapo:function(){return"capo"===this.user.role&&this.user.gang===this.id}},created:function(){var e=this;this.isInit=!0;var s=[c["a"].requestAsync("get_gang",this.id),c["a"].requestAsync("get_gang_members",this.id)];["boss","capo"].includes(this.user.role)&&s.push(c["a"].requestAsync("get_gang_applies",this.id)),l.a.all(s).then((function(s){var t=Object(o["a"])(s,3),a=Object(o["a"])(t[0],1);e.gang=a[0],e.members=t[1],e.applies=t[2],e.isInit=!1}))},methods:Object(i["a"])({},Object(r["b"])(["send","notify"]),{resetForm:function(){this.message=null},handleSubmit:function(){var e=this,s=this;this.isLoading=!0;var t={gang:this.id,type:"gang-soldier-apply"};this.message&&(t.message=this.message),this.send(t).then((function(){s.isLoading=!1,e.resetForm()})).catch((function(s){e.notify({type:"error",message:"Failed to apply as soldier"}),console.error("Failed to apply as soldier",s),e.isLoading=!1}))},handleApprove:function(e){var s=this,t=this;this.isLoading=!0;var a={gang:this.id,soldier:e,type:"gang-approve-soldier"};this.send(a).then((function(){setTimeout((function(){var e=[c["a"].requestAsync("get_gang",t.id),c["a"].requestAsync("get_gang_members",t.id)];["boss","capo"].includes(t.user.role)&&e.push(c["a"].requestAsync("get_gang_applies",t.id)),l.a.all(e).then((function(e){var s=Object(o["a"])(e,3),a=Object(o["a"])(s[0],1);t.gang=a[0],t.members=s[1],t.applies=s[2],t.isLoading=!1}))}),3e3)})).catch((function(e){s.notify({type:"error",message:"Failed to approve soldier"}),console.error("Failed to approve soldier",e),s.isLoading=!1}))},handleReject:function(e){var s=this,t=this;this.isLoading=!0;var a={gang:this.id,soldier:e,type:"gang-reject-soldier"};this.send(a).then((function(){setTimeout((function(){var e=[c["a"].requestAsync("get_gang",t.id),c["a"].requestAsync("get_gang_members",t.id)];["boss","capo"].includes(t.user.role)&&e.push(c["a"].requestAsync("get_gang_applies",t.id)),l.a.all(e).then((function(e){var s=Object(o["a"])(e,3),a=Object(o["a"])(s[0],1);t.gang=a[0],t.members=s[1],t.applies=s[2],t.isLoading=!1}))}),3e3)})).catch((function(e){s.notify({type:"error",message:"Failed to reject candidate"}),console.error("Failed to reject candidate",e),s.isLoading=!1}))}})},u=d,p=t("2877"),m=Object(p["a"])(u,a,n,!1,null,null,null);s["default"]=m.exports}}]);
//# sourceMappingURL=gang.e4c1f8c0.js.map